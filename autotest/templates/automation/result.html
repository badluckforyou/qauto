<!DOCTYPE html>
{% load static %}
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>{{ title }}</title>
    <!-- plugins:css -->
    <link rel="stylesheet" href="{% static 'vendors/iconfonts/mdi/css/materialdesignicons.css' %}">
    <!-- endinject -->
    <!-- vendor css for this page -->
    <!-- End vendor css for this page -->
    <!-- inject:css -->
    <link rel="stylesheet" href="{% static 'css/shared/style.css' %}">
    <!-- endinject -->
    <!-- Layout style -->
    <link rel="stylesheet" href="{% static 'css/demo_1/style.css' %}">
    <!-- Layout style -->
    <link rel="shortcut icon" href="{% static 'images/favicon.ico' %}" />
    <script type="text/javascript">
      window.onload = function(){
        $("#project").val("{{ project }}");
        $("#date").val("{{ date }}");
      }
    </script>
  </head>
  <body class="header-fixed" id="thebody">
    <!-- partial:partials/_header.html -->
    <nav class="t-header">
      <div class="t-header-brand-wrapper">
        <a>
          <img class="logo" src="{% static 'images/logo.png' %}" alt="">
          <img class="logo-mini" src="{% static 'images/logo_mini.png' %}" alt="">
        </a>
      </div>
      <div class="t-header-content-wrapper">
        <div class="t-header-content">
          <button class="t-header-toggler t-header-mobile-toggler d-block d-lg-none">
            <i class="mdi mdi-menu"></i>
          </button>
          <form action="#" class="t-header-search-box">
            <div class="input-group">
              <input type="text" class="form-control" id="inlineFormInputGroup" placeholder="Search" autocomplete="off">
              <button class="btn btn-primary" type="submit"><i class="mdi mdi-arrow-right-thick"></i></button>
            </div>
          </form>
          {% if user.is_authenticated %}
          <ul class="nav ml-auto">
            <li class="nav-item dropdown">
              <a class="nav-link" href="#" id="notificationDropdown" data-toggle="dropdown" aria-expanded="false">
                <i class="mdi mdi-account mdi-1x">{{ username }}</i>
              </a>
              <div class="dropdown-menu navbar-dropdown dropdown-menu-right" aria-labelledby="notificationDropdown" style="width: 130px;">
                <div class="dropdown-body">
                  <div class="dropdown-list">
                    <div class="rounded-circle bg-inverse-primary text-primary">
                    </div>
                    <div class="content-wrapper" onclick="location.href='/user/';">
                      <small class="content-text">My information</small>
                    </div>
                  </div>
                  <div class="dropdown-list" onclick="location.href='/login/';">
                    <div class="rounded-circle bg-inverse-warning text-warning">
                    </div>
                    <div class="content-wrapper">
                      <small class="content-text">Logout</small>
                    </div>
                  </div>
                </div>
              </div>
            </li>
          </ul>
          {% else %}
          <ul class="nav ml-auto">
            <li class="nav-item dropdown">
              <a class="nav-link" href="/login/">
                <i class="mdi-1x">Go to Login</i>
              </a>
            </li>
          </ul>
          {% endif %}
        </div>
      </div>
    </nav>
    <!-- partial -->
    <div class="page-body">
      <!-- partial:partials/_sidebar.html -->
      <div class="sidebar">
        <div class="user-profile">
          <div class="display-avatar animated-avatar">
            <img class="profile-img img-lg rounded-circle" src="{% static 'images/image.png' %}" alt="profile image">
          </div>
          <div class="info-wrapper">
            <h3 class="user-name">{{ company }}</h3>
          </div>
        </div>
        {% if user.is_authenticated %}
        <ul class="navigation-menu">
          <li class="nav-category-divider">HOME</li>
          <li>
            <a href="/home/">
              <span class="link-title">‰∏ªÈ°µ</span>
              <i class="mdi mdi-home link-icon"></i>
            </a>
          </li>
          <li class="nav-category-divider">AUTOMATED TESTING</li>
          <li>
            <a href="/automation/">
              <span class="link-title">Ëá™Âä®ÂåñÊµãËØï</span>
              <i class="mdi mdi-application link-icon"></i>
            </a>
          </li>
          <li>
            <a>
              <span class="link-title">ÁªìÊûú</span>
              <i class="mdi mdi-application link-icon"></i>
            </a>
          </li>
          <li class="nav-category-divider">API TESTING</li>
          <li>
            <a href="/api/">
              <span class="link-title">Êé•Âè£ÊµãËØï</span>
              <i class="mdi mdi-application link-icon"></i>
            </a>
          </li>
          <li>
            <a href="/api/result/">
              <span class="link-title">ÁªìÊûú</span>
              <i class="mdi mdi-application link-icon"></i>
            </a>
          </li>
          <li class="nav-category-divider">STRESS TESTING</li>
          <li>
            <a href="/stress/">
              <span class="link-title">ÂéãÂäõÊµãËØï</span>
              <i class="mdi mdi-application link-icon"></i>
            </a>
          </li>
          <li>
            <a href="/stress/result/">
              <span class="link-title">ÁªìÊûú</span>
              <i class="mdi mdi-application link-icon"></i>
            </a>
          </li>

          <li class="nav-category-divider">USER</li>
          <li>
            <a href="/user/">
              <span class="link-title">My Information</span>
              <i class="mdi mdi-account link-icon"></i>
            </a>
          </li>
        </ul>
        {% endif %}
      </div>
      <!-- partial -->
      <div class="page-content-wrapper">
        <div class="page-content-wrapper-inner">
          <div class="content-viewport" style="float: left;">
            <div class="row">
              <div class="modal" id="newUrl" data-backdrop="true" style="position: fixed; ">
                <div class="modal-dialog modal-lg">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h6 class="modal-title" style="font-size: 20px;">
                        <strong>Url</strong>
                      </h6>
                    </div>
                    <div class="modal-body">
                      <span class="text-gray" style="font-size: 14px; white-space: pre-wrap;" id="url"></span>
                    </div>
                  </div>
                </div>
              </div>
              <div class="modal" data-backdrop="true" id="log" style="position: fixed; ">
                <div class="modal-dialog modal-lg" id="log_dialog">
                  <div class="modal-content" id="log_content">
                    <div class="modal-header" id="log_header">
                      <h6 class="modal-title" style="font-size: 20px;">
                        <strong>Log</strong>
                      </h6>
                    </div>
                    <div class="modal-body">
                      <span class="text-gray" style="font-size: 14px; white-space: pre-wrap;" id="logMessage"></span>
                    </div>
                  </div>
                </div>
              </div>
              <div class="modal" id="report" data-backdrop="true" style="position: fixed;">
                <div class="modal-dialog modal-lg">
                  <div class="modal-content" id="report_content">
                    <div class="modal-header">
                      <h6 class="modal-title" style="font-size: 20px">
                        <strong>Report</strong>
                      </h6>
                    </div>
                    <div class="modal-body">
                      <label style="font-size: 18px;">Case Information</label>
                      <div>
                        <span class="text-gray" style="font-size: 12px; white-space : pre-wrap;" id="caseInfomation"></span>
                      </div>
                      <label>&nbsp;</label>
                      <div></div>
                      <label style="font-size: 18px;">Screenshot</label>
                      <div id="screenshot"></div>
                    </div>
                  </div>
                </div>
              </div>
              {% if user.is_authenticated %}
              <div class="col-12">
                <div class="grid" style="height: 60px;">
                  <div class="grid-body text-gray">
                    <div class="header">
                      <form method="GET" id="projects" name="projects">
                        <select class="custom-select" id="project" name="project" style="width: 250px;float: left;padding: 0 15px;height: 30px">
                          {% for project in projects %}
                          <option>{{ project }}</option>
                          {% endfor %}
                        </select>
                        {% ifnotequal project 'All' %}
                        <select class="custom-select" id="date" name="date" style="width: 250px;float: left;padding: 0 15px;height: 30px">
                          {% for date in dates %}
                          <option>{{ date }}</option>
                          {% endfor %}
                        </select>
                        {% endifnotequal %}
                        {% csrf_token %}
                      </form>
                    </div>
                  </div>
                </div>
              </div>
              {% endif %}
              <div class="col-md-5 equal-gird">
                <div class="grid">
                  <div class="grid-body py-3">
                    <div class="split-header">
                      <p class="card-title">Statistics</p>
                    </div>
                  </div>
                  <div id="radial-chart"></div>
                  <!-- <canvas class="apexcharts-canvas resultCanvas" id="doughnutChart" width="600px;" height="400px;">
                    Ê≠§ÊµèËßàÂô®‰∏çÊîØÊåÅcanvas, Êó†Ê≥ïÊòæÁ§∫ÁªìÊûúÊï∞ÊçÆÂõæ!!!
                  </canvas> -->
                </div>
              </div>
              <div class="col-md-7 equal-gird">
                <div class="grid">
                  <div class="grid-body py-3">
                    <div class="split-header">
                      <p class="card-title">Summary</p>
                    </div>
                    <br>
                    <div class="d-flex justify-content-between border-bottom py-2">
                      <h5>INFORMATION OF THE RESULT</h5>
                    </div><br>
                    <div class="d-flex justify-content-between border-bottom py-2">
                      Project:&nbsp;&nbsp;{{ project }}
                    </div><br>
                    <div class="d-flex justify-content-between border-bottom py-2">
                      Runtime:&nbsp;&nbsp;{{ date }}
                    </div><br>
                    <div class="d-flex mt-2">
                      ÊâÄÊúâÁî®‰æã:&nbsp;&nbsp;&nbsp;<span style="color:#696ffb" id="totalNum"></span>
                    </div>
                    <div class="d-flex mt-2">
                      ÊàêÂäüÁî®‰æã:&nbsp;&nbsp;&nbsp;<span style="color:#4CCEAC" id="successNum"></span>
                    </div>
                    <div class="d-flex mt-2">
                      Â§±Ë¥•Áî®‰æã:&nbsp;&nbsp;&nbsp;<span style="color:#f5003a" id="failNum"></span>
                    </div>
                    <div class="item-wrapper">
                      <label><br></label>
                    </div>
                    <div class="item-wrapper">
                      {% if user.is_authenticated %}
                      <button class="btn btn-secondary" onclick="generateUrl()" data-toggle="modal" data-target="#newUrl">
                        ÂàÜ‰∫´Áªô‰ªñ‰∫∫
                      </button>
                      {% else %}
                      <br><br>
                      {% endif %}
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-12">
                <div class="grid">
                  <div class="grid-body py-3">
                    <div class="split-header">
                      <p class="card-title">Result</p>
                    </div>
                  </div>
                  <div class="table-responsive">
                    <table id="table" name="table" class="table table-hover">
                      <thead>
                        <tr class="solid-header">
                          <th style="width: 250px;">Case Name</th>
                          <th style="width: 100px;">Exec Time</th>
                          <th style="width: 100px;">Result Wanted</th>
                          <th style="width: 100px;">Result Infact</th>
                          <th style="width: 80px;">Test Result</th>
                          <th style="width: 80px;">Cost Time</th>
                          <th style="width: 20px;">Operation</th>
                          <!-- <th style="width: 100px;">ËøêË°åÊó•Âøó</th> -->
                          <!-- <th style="width: 100px;">ËØ¶ÁªÜÊä•Âëä</th> -->
                        </tr>
                      </thead>
                      <tbody id="result" name="result">
                        {% for item in data %}
                        <tr id="trid">
                          <td style = "word-wrap:break-word;white-space:normal;">{{ item.casename }}</td>
                          <td style = "word-wrap:break-word;white-space:normal;">{{ item.runtime }}</td>
                          <td style = "word-wrap:break-word;white-space:normal;">{{ item.resultwanted }}</td>
                          <td style = "word-wrap:break-word;white-space:normal;">{{ item.resultinfact }}</td>
                          <td style = "word-wrap:break-word;white-space:normal;">{{ item.testresult }}</td>
                          <td style = "word-wrap:break-word;white-space:normal;">{{ item.costtime }}</td>
                          <td >
                            <div class="btn-group">
                              <button type="button" class="btn btn-trasnparent action-btn btn-xs component-flat pr-0" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="mdi mdi-dots-vertical"></i>
                              </button>
                              <div class="dropdown-menu dropdown-menu-right">
                                <button class="dropdown-item" data-toggle="modal" data-target="#log" onclick="showLog('{{ item.log }}')">View Exec-log</button>
                                <button class="dropdown-item" data-toggle="modal" data-target="#report" onclick="showReport('{{ item.report }}', '{{ item.image }}')">View Report</button>
                              </div>
                            </div>
                          </td>
                          <!-- <td style = "word-wrap:break-word;white-space:normal;">
                            <button class="btn btn-secondary has-icon btn-block mt-0" onclick="showLog('{{ item.log }}')" style="height: 25px;padding: 0 15px;" data-toggle="modal" data-target="#log">
                              Êü•Áúã
                            </button>
                          </td>
                          <td style = "word-wrap:break-word;white-space:normal;">
                            <button class="btn btn-secondary has-icon btn-block mt-0" onclick="showReport('{{ item.report }}', '{{ item.image }}')" style="height: 25px;padding: 0 15px;" data-toggle="modal" data-target="#report">
                              Êü•Áúã
                            </button>
                          </td> -->
                          <!-- <td style = "word-wrap:break-word;white-space:normal;">
                            <button class="btn btn-inverse-info btn-xs" id="delbtn" onclick="goToNewHtml('{{ item.GAME }}','{{ item.REPORT }}' )">
                              Êü•Áúã
                            </button>
                            <button class="btn btn-inverse-info btn-xs" data-toggle="modal" data-target="#the_grandchild_case" class="button button-rounded button-tiny fontstyle fontsize" onclick="editRow(this)">
                              ‰∏ãËΩΩ
                            </button>
                            <button class="btn btn-inverse-info btn-xs" id="delbtn" onclick="delRow('{{ grandchildrow.Id }}')">
                              ÈÇÆÁÆ±
                            </button>
                          </td> -->
                        </tr>
                        {% endfor %}
                      </tbody>
                    </table>
                  </div>
                  <!-- <div style="position: absolute; right: 100px;bottom: 30px;"> -->
                  <div style="float: right; margin-right: 150px;">
                    {% if not data.has_previous%}
                    <span><a>First </a></span>&nbsp;|
                    {% else %}
                    {% if user.is_authenticated %}
                    <span><a href="?project={{ project }}&date={{ date }}&page=1">First </a></span>&nbsp;|
                    {% else %}
                    <span id="firstPage">1</span>&nbsp;|
                    {% endif %}
                    {% endif %}
                    {% if data.has_previous %}
                    {% if user.is_authenticated %}
                    <span><a href="?project={{ project }}&date={{ date }}&page={{ data.previous_page_number }}">Previous </a></span>&nbsp;|
                    {% else %}
                    <span id="previousPage">{{ data.previous_page_number }}</span>&nbsp;|
                    {% endif%}
                    {% else %}
                    <span>Previous </span>&nbsp;|
                    {% endif %}
                    {% if data.has_next %}
                    {% if user.is_authenticated %}
                    <span><a href="?project={{ project }}&date={{ date }}&page={{ data.next_page_number }}">Next </a></span>&nbsp;|
                    {% else %}
                    <span id="nextPage">{{ data.next_page_number }}</span>&nbsp;|
                    {% endif %}
                    {% else %}
                    <span><a>Next </a></span>&nbsp;|
                    {% endif %}
                    {% if data.has_next %}
                    {% if user.is_authenticated %}
                    <span><a href="?project={{ project }}&date={{ date }}&page={{ data.paginator.num_pages }}">Last </a></span>&nbsp;|
                    {% else %}
                    <span id="lastPage">{{ data.paginator.num_pages }}</span>&nbsp;|
                    {% endif %}
                    {% else %}
                    <span><a>Last </a></span>&nbsp;|
                    {% endif %}
                    &nbsp;Page&nbsp;<span><a id="thisPage">{{ data.number }}</a></span>/<span><a id="totalPage">{{ data.paginator.num_pages }}</a></span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- page content ends -->
    </div>
    <!--page body ends -->
    <!-- SCRIPT LOADING START FORM HERE /////////////-->
    <!-- plugins:js -->
    <script src="{% static 'vendors/js/core.js' %}"></script>
    <!-- endinject -->
    <!-- Vendor Js For This Page Ends-->
    <script src="{% static 'vendors/apexcharts/apexcharts.min.js' %}"></script>
    <script src="{% static 'vendors/chartjs/Chart.min.js' %}"></script>
    <script src="{% static 'js/charts/chartjs.addon.js' %}"></script>
    <!-- Vendor Js For This Page Ends-->
    <!-- build:js -->
    <script src="{% static 'js/template.js' %}"></script>
    <!-- <script src="{% static 'js/dashboard.js' %}"></script> -->
    <!-- endbuild -->
    <script type="text/javascript">
      $(window).on("load", function(){
        $("table tr").each(function(){
          // ÊØèÂàóÁöÑÊµãËØïÁªìÊûúÈÉΩÈúÄË¶ÅËøõË°åË∞ÉËâ≤
          var fiveTd = $(this).find("td:eq(4)");
          if (fiveTd.text() == "Â§±Ë¥•"){
            fiveTd.css("color", "#f5003a");
          }
          else if (fiveTd.text() == "ÈÄöËøá"){
            fiveTd.css("color", "#4CCEAC");
          }
           // Áî®‰æãÂêçÁöÑÁúÅÁï•
          var caseName = $(this).find("td:eq(0)");
          caseName.attr("title", caseName.text());
          var length = caseName.text().length;
          if (length >= 30) {
            var front = caseName.text().substring(0, 25);
            var offside = caseName.text().substring(length - 5, length);
            var content = front + "&nbsp;&nbsp;...&nbsp;&nbsp;" + offside;
            caseName.html(content);
          }
          caseName.mouseover(function(){
            $(this).tooltip;
          });
        });
        $("#projects").change(function(){
          $("#projects").submit();
        });
        var succ = 0;
        var fail = 0;
        var data = JSON.parse("{{ result }}".replace(/&#x27;/g, '"'));
        for (i=0; i<data.length; i++){
          if (data[i] == "ÈÄöËøá"){
            succ++;
          }
          else if (data[i] == "Â§±Ë¥•"){
            fail++;
          }
        }
        var total = succ + fail;
        var percent = ((succ / total) * 100).toFixed(1);
        // doughnut chart
        if ($("#doughnutChart").length) {
          var doughnutChartCanvas = $("#doughnutChart").get(0).getContext("2d");
          var doughnutData = {
            datasets: [{
              data: [succ, fail],
              backgroundColor: ["#4CCEAC", "#f5003a"],
              borderColor: ["#4CCEAC", "#f5003a"],
              borderWidth: ["#4CCEAC", "#f5003a"]
            }],
            labels: [
              "ÈÄöËøá",
              "Â§±Ë¥•",
            ],
          };
          var doughnutOptions = {
            responsive: true,
            showTooltips: false,
            cutoutPercentage: 40, //ÂÜÖÈÉ®ÁôΩËâ≤Âå∫ÂüüÊâÄÂç†ÁöÑÁôæÂàÜÊØî
            segmentShowStroke: false,
            animation: {
              animateScale: true, // doughnut chartÂä®Áîª‰ªé‰∏≠ÂøÉÂêëÂ§ñÊâ©Âº†
              animateRotate: true, // doughnut chart‰ΩøÁî®ÊóãËΩ¨Âä®Áîª
              onComplete: function(){
                // console.log("üò† Please do not keep your mouse moving on the doughnut chart!!!");
                // console.log("üòä If you don't, leave and let me alone ~~");
              }
            },
          };
          var doughnutChart = new Chart(doughnutChartCanvas, {
            type: "doughnut",
            data: doughnutData,
            options: doughnutOptions,
          });
          Chart.pluginService.register({
            beforeDraw: function(chart){
              var height = chart.chart.height;
              var width = chart.chart.width;
              var doughnut = chart.chart.ctx;
              doughnut.restore();
              // doughnutChartCanvas.font = fontsize + "em Verdana";
              doughnut.font = Chart.helpers.fontString(Chart.defaults.global.defaultFontSize, Chart.defaults.global.defaultFontStyle, Chart.defaults.global.defaultFontFamily)
              doughnut.textBaseline = "middle";

              var msg = "ÈÄöËøáÁéá";
              var msgWidth = doughnut.measureText(msg).width;
              var msgPosX = Math.round((width - msgWidth) / 2);
              var msgPosY = Math.round(height / 2 + 5);
              doughnut.fillText(msg, msgPosX, msgPosY);

              percent = percent + "%";
              if (total == 0){
                percent = "0.00%";
              }
              var percentWidth = doughnut.measureText(percent).width;
              var percentPosX = Math.round((width - percentWidth) / 2);
              var percentPosY = Math.round(height / 2 + 25);
              doughnut.fillText(percent, percentPosX, percentPosY);
              doughnut.save();
            }
          });
        }
        if ($("#radial-chart").length) {
          data = {
            chart: {
              height: 360,
              type: "radialBar"
            },
            series: [percent],
            colors: ["#4CCEAC"],
            plotOptions: {
              radialBar: {
                hollow: {
                    margin: 0,
                    size: "70%",
                    background: "rgba(255,255,255,0.1)"
                },
                track: {
                  dropShadow: {
                      enabled: !0,
                      top: 2,
                      left: 0,
                      blur: 4,
                      opacity: .02
                  }
                },
                dataLabels: {
                    name: {
                        offsetY: -10,
                        color: "#adb5bd",
                        fontSize: "15px"
                    },
                    value: {
                        offsetY: 5,
                        color: "#000000",
                        fontSize: "18px",
                        show: !0
                    }
                }
              }
            },
            fill: {
              type: "gradient",
              gradient: {
                shade: "dark",
                type: "vertical",
                gradientToColors: ["#87D4F9"],
                stops: [0, 100]
              }
            },
            stroke: {
              lineCap: "round"
            },
            labels: ["Pass Rate"]
          };
          (r = new ApexCharts(document.querySelector("#radial-chart"), data)).render()
        }
        $("#totalNum").html(total);
        $("#successNum").html(succ);
        $("#failNum").html(fail);
      });
      /****** Ë∑≥ËΩ¨Âà∞Êñ∞ÁöÑÈ°µÈù¢ ******/
      function goToNewHtml(game, report){
        window.open("/report/?game=" + game + "&report=" + report, "_blank");
      }
      function setModalHeight(modal, height){
        modal.css("display", "block");
        modal.find(".modal-dialog").css({
          "margin-top": height,
        });
      }
      var halfWindowHeight = $(window).height() / 2;
      /****** ËÆæÁΩÆmodal newUrl ÊòæÁ§∫ÁöÑÂùêÊ†á ******/
      $("#newUrl").on("show.bs.modal", function(e){
        setModalHeight($(this), halfWindowHeight)
      });
      /****** ËÆæÁΩÆmodal log ÊòæÁ§∫ÁöÑÂùêÊ†á ******/
      $("#log").on("show.bs.modal", function(e){
        setModalHeight($(this), halfWindowHeight)
      });
      /****** ËÆæÁΩÆmodal log ÊòæÁ§∫ÁöÑÂÜÖÂÆπ ******/
      function showLog(log){
        $("#logMessage").html(log.replace(/"/g, ""));
        $("#log").on("show.bs.modal", function(e){
          var modalHeight = $(this).find(".modal-dialog").height();
          var windowHeight = $(window).height();
          if (modalHeight < windowHeight) {
            setModalHeight($(this), (windowHeight - modalHeight) / 2);
          }
          else {
            setModalHeight($(this), 100);
          }
        });
      }
      /****** ËÆæÁΩÆmodal report ÊòæÁ§∫ÁöÑÂùêÊ†á ******/
      $("#report").on("show.bs.modal", function(e){
        setModalHeight($(this), 150)
      });
      /****** ËÆæÁΩÆmodal report ÊòæÁ§∫ÁöÑÂÜÖÂÆπ ******/
      function showReport(report, image){
        $("#caseInfomation").html(report.replace(/"/g, ""));
        // imageÂèØËÉΩÂåÖÂê´ÂæàÂ§öÂº†ÂõæÁâá, Âõ†Ê≠§ÈúÄË¶ÅËøõË°åÂàáÁâáÊ£ÄÊµã
        var images = image.split(",");
        var imgsrc = "";
        for (const image of images) {
          imgsrc += '<img src="' + image +'" alt="ÂõæÁâáÊó†Ê≥ïÊòæÁ§∫" style="width: 100%; height: auto;">';
        }
        $("#screenshot").html(imgsrc);
        // $("#report").on("show.bs.modal", function(e){
        //   var modalHeight = $(this).find(".modal-dialog").height();
        //   var windowHeight = $(window).height();
        //   console.log("report", modalHeight, windowHeight)
        //   if (modalHeight < windowHeight) {
        //     setModalHeight($(this), (windowHeight - modalHeight) / 2)
        //   }
        // });
      }
      /****** ÁîüÊàêtableÁöÑÂâçÂêéÈ°µÁ≠âÁöÑË∑≥ËΩ¨url ******/
      function getNewHtml(page, keyWord){
        var url = this.location.search;
        var pageEqual = url.indexOf("&page=");
        if (pageEqual > 0) {
          url = url.replace(url.substring(pageEqual, url.length), "&page=" + page);
        }
        else {
          url += '&project={{ project }}&page=' + page
        }
        var newHtml = '<a href="' + url + '">' + keyWord + ' </a>';
        return newHtml
      }
      $("#firstPage").html(getNewHtml($("#firstPage").text(), "First"));
      $("#previousPage").html(getNewHtml($("#previousPage").text(), "Previous"));
      $("#nextPage").html(getNewHtml($("#nextPage").text(), "Next"));
      $("#lastPage").html(getNewHtml($("#lastPage").text(), "Last"));
      /****** ÁîüÊàê‰æõ‰ªñ‰∫∫Êü•ÁúãËá™Â∑±Áî®‰æãÁöÑurl ******/
      function generateUrl(){
        var scheme = this.location.protocol;
        var host   = this.location.host;
        var path   = this.location.pathname;
        var query  = this.location.search;
        if (query == "") {
          var newQuery = "&project=" + $("#project").val() + "&page=" + $("#thisPage").html();
        }
        else if (query.indexOf("&time=") > 0) {
          var newQuery = query.substring(0, query.indexOf("&time=")) + "&page=" + $("#thisPage").html();
        }
        else if (query.indexOf("&time=") == -1 && query.indexOf("&csrfmiddlewaretoken=") > 0) {
          var newQuery = query.substring(0, query.indexOf("&csrfmiddlewaretoken=")) + "&page=" + $("#thisPage").html();
        }
        else if (query.indexOf("&time=") > 0) {
          var newQuery = query + "&page=" + $("#thisPage").html();
        }
        else {
          var newQuery = query;
        }
        var finalQuery = newQuery.substring(newQuery.indexOf("&project"), newQuery.length);
        var url = scheme + "//" + host + path + "?u={{ username }}&" + finalQuery.substring(1, finalQuery.length)
        $("#url").html(url);
      }
    </script>
  </body>
</html>




















